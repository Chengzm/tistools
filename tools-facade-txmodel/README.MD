>业务域

	交易服务模式 Tx-Model

>作用

	负责处理交易办理过程中，各种操作发出的操作处理请求。
	交易服务模式，接受到交易请求，并按照交易所属行为分类（AC_FUNC_BHVTYPE）和本次交易请求行为（AC_FUNC_BHV）来执行对应的操作处理逻辑，处理完成后，返回处理结果；
	通常，一个交易的办理流程中，可能多次调用交易服务模式，
	如：
	
	打开交易 -->（录入数据）--> 暂存交易 --> 补录交易 --> 提交交易 --> 交易结束 ；
	
	又或者：
	
	打开交易 -->（录入数据） --> 提交交易 --> 交易复核 --> 交易授权 --> 授权后提交 --> 交易结束 ；

>调用

	请求者组织好交易请求，调用交易模式服务，处理后，返回交易响应；
	
``` java
	TxResponse ITxModelRService.execute(TxRequest txRequest);
```

-----------

>与交易引擎相关的概念介绍

>>交易
	
	一种‘功能类型’等于‘交易’的特殊功能（AC_FUNC.FUNC_TYPE＝‘交易’）。
	
	交易可以有多种‘行为类型’特性，但是，每个交易操作只属于唯一的行为（BHV_CODE）；

>>行为类型 （AC_BHVTYPE_DEF.BHVTYPE_CODE）

	按照交易的办理的过程，抽象出来的交易操作归类方式，比如账务交易办理过程、维护类交易办理过程，... ， 每种分类叫做一种‘行为类型（BHVTYPE_CODE）’。
	
	是对‘交易操作’的归类。
	
	一种行为类型，对应一种“交易模式”实现，如：
	
		‘账务类’交易模式服务
		‘维护类’交易模式服务
		‘查询类’交易模式服务
		...交易模式服务 —— 根据业务特性做扩展开发
		
	交易会有一些统一的行为，比如：有统一的请求／响应数据结构，交易引擎都会记录交易流水，记录每个操作行为的操作日志；

>>操作行为（AC_BHV_DEF.BHV_CODE）
	
	交易办理过程的某个处理步骤。
	
	同一个操作行为可能有多种实现，以适应业务变化，如：
	
	同样是‘交易提交’操作，账务类交易会请求某个主机服务，而维护类交易则只需要进行本地数据库操作。
	
	某种交易模式服务，是由众多操作行为构成。

>>交易服务
	
	“交易”作为一种服务级资源，可以通过类似RESTFul规范（不是严格的RESTFul规范）进行调用，
	
	对交易的每个操作都是一次服务过程 —— “请求-处理-响应”，如：
	
	打开交易服务
	
	POST http://ip:port/txengin/TX010505/open-tx
	
	version:v1.0.1
	Content-Type:application/json
	...
	
	打开交易的交易请求
	
	{
		"header":{
			"txCode":"TX010505",
			"BHV":"open-tx",
			"serialNo":"",
			"channelCode":"TWS",
			"operator":"660001"
			"time":"20170921210245427"
			...
		},
		"control":{},
		"requestData":{}
	}
	
	打开交易的交易响应
	
	{
		"header":{"deviceId":"359651042552676","deviceOS":"Android","mobilType":"samsungsmdk4210","versionNo":"2.1.00"},
		"control":{"txToken":"CDKYDK-KAJKK-WIEJK-0300"},
		"responseData":{ "serialNo":"20170921205899010001" }
	}

>>交易请求 TxRequest

	请求者发送给服务端的交易请求数据信息。
	
	交易请求对象的结构示意：
	
``` json

	交易请求:{
		请求头:{
			交易码
			操作行为
			交易流水
			渠道代码
			操作员
			操作时间
			...
		},
		控制体:{
			翻页控制参数
			...
		},
		请求数据:{
			账号
			金额
			户名
			...
		}
	}
```

	请求头：请求者，发出交易请求时的环境信息，服务端可根据这些信息识别请求来源，进行认证处理。
	控制体：请求者发送行为控制的参数给服务端，服务端以控制体信息执行特别逻辑处理，如：翻页控制。
	请求数据：请求者将执行交易处理需要的数据发送给服务端，如：当前交易界面上的数据、某条交易的流水号...。
	
	
>>交易响应 TxResponse

	服务端对交易请求处理完成后，返回给请求者的数据信息。
	
	交易响应对象的结构示意：
	
``` json
	交易响应:{
		响应头:{
			交易码
			操作行为
			交易流水
			渠道代码
			操作员
			操作时间
			...
		},
		控制体:{
			授权控制参数
			复核控制参数
			...
		}
		响应数据:{
			账号
			金额
			户名
			...
		}
	}
```

	响应头：一般直接返回原请求者的发出请求头信息，有需要时，也会对其中的数据进行变更后返回，如：交易流水号重复提交时，可以返回新的流水号。
	控制体：服务端通过控制体返回对请求者的行为控制参数，如：授权控制参数、复核控制参数....。请求者收到这些控制参数后，必需根据控制参数做相应的处理。
	响应数据：服务端将交易处理结果数据返回给请求者。
	
	